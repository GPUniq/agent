{"openapi":"3.1.0","info":{"title":"GPUniq Backend API","description":"GPU rental platform backend API","version":"1.0.0"},"paths":{"/":{"get":{"summary":"Read Root","operationId":"read_root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/v1/auth/register":{"post":{"tags":["API v1","Authorization"],"summary":"Register User","description":"Регистрация нового пользователя с отправкой кода подтверждения на email","operationId":"register_user_v1_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRegisterSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/auth/confirm-registration":{"post":{"tags":["API v1","Authorization"],"summary":"Confirm Registration","description":"Подтверждение регистрации пользователя по коду из email","operationId":"confirm_registration_v1_auth_confirm_registration_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfirmRegisterSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/auth/login":{"post":{"tags":["API v1","Authorization"],"summary":"Login User","description":"Логин пользователя и получение JWT токенов","operationId":"login_user_v1_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserLoginSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/auth/me":{"get":{"tags":["API v1","Authorization"],"summary":"Get User Profile","description":"Получение профиля текущего пользователя","operationId":"get_user_profile_v1_auth_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}}},"security":[{"HTTPBearer":[]}]}},"/v1/auth/refresh-token":{"post":{"tags":["API v1","Authorization"],"summary":"Refresh Token","description":"Обновление токена (legacy)","operationId":"refresh_token_v1_auth_refresh_token_post","requestBody":{"content":{"application/json":{"schema":{"type":"object","title":"Data"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/marketplace/list":{"get":{"tags":["API v1","Marketplace"],"summary":"Get Marketplace List","description":"Получение списка доступных GPU/агентов с фильтрацией","operationId":"get_marketplace_list_v1_marketplace_list_get","parameters":[{"name":"gpu_model","in":"query","required":false,"schema":{"type":"string","description":"GPU model filter","title":"Gpu Model"},"description":"GPU model filter"},{"name":"min_ram_gb","in":"query","required":false,"schema":{"type":"integer","description":"Minimum RAM in GB","title":"Min Ram Gb"},"description":"Minimum RAM in GB"},{"name":"max_ram_gb","in":"query","required":false,"schema":{"type":"integer","description":"Maximum RAM in GB","title":"Max Ram Gb"},"description":"Maximum RAM in GB"},{"name":"min_price_per_hour","in":"query","required":false,"schema":{"type":"number","description":"Minimum price per hour","title":"Min Price Per Hour"},"description":"Minimum price per hour"},{"name":"max_price_per_hour","in":"query","required":false,"schema":{"type":"number","description":"Maximum price per hour","title":"Max Price Per Hour"},"description":"Maximum price per hour"},{"name":"location","in":"query","required":false,"schema":{"type":"string","description":"Location filter","title":"Location"},"description":"Location filter"},{"name":"min_vram_gb","in":"query","required":false,"schema":{"type":"integer","description":"Minimum VRAM in GB","title":"Min Vram Gb"},"description":"Minimum VRAM in GB"},{"name":"max_vram_gb","in":"query","required":false,"schema":{"type":"integer","description":"Maximum VRAM in GB","title":"Max Vram Gb"},"description":"Maximum VRAM in GB"},{"name":"page","in":"query","required":false,"schema":{"type":"integer","description":"Page number","default":1,"title":"Page"},"description":"Page number"},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","description":"Page size","default":20,"title":"Page Size"},"description":"Page size"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/marketplace/agent/{agent_id}":{"get":{"tags":["API v1","Marketplace"],"summary":"Get Agent Details","description":"Получение подробной карточки агента/сервера","operationId":"get_agent_details_v1_marketplace_agent__agent_id__get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"integer","title":"Agent Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/marketplace/order":{"post":{"tags":["API v1","Marketplace"],"summary":"Create Order","description":"Создание заказа на аренду","operationId":"create_order_v1_marketplace_order_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderCreateSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/v1/instances/my":{"get":{"tags":["API v1","Instances"],"summary":"Get My Instances","description":"Получение списка арендованных экземпляров пользователя","operationId":"get_my_instances_v1_instances_my_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","description":"Page number","default":1,"title":"Page"},"description":"Page number"},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","description":"Page size","default":20,"title":"Page Size"},"description":"Page size"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/instances/{task_id}":{"get":{"tags":["API v1","Instances"],"summary":"Get Instance Details","description":"Получение подробной информации по задаче/экземпляру","operationId":"get_instance_details_v1_instances__task_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["API v1","Instances"],"summary":"Delete Instance","description":"Удаление аренды/экземпляра","operationId":"delete_instance_v1_instances__task_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/instances/{task_id}/start":{"post":{"tags":["API v1","Instances"],"summary":"Start Instance","description":"Запуск задачи вручную","operationId":"start_instance_v1_instances__task_id__start_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/instances/{task_id}/stop":{"post":{"tags":["API v1","Instances"],"summary":"Stop Instance","description":"Остановка аренды (контейнера)","operationId":"stop_instance_v1_instances__task_id__stop_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/agents/register":{"post":{"tags":["API v1","Agents"],"summary":"Register Agent","description":"Регистрация агента (только owner_user_id)","operationId":"register_agent_v1_agents_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentRegisterSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/agents/{agent_id}/heartbeat":{"post":{"tags":["API v1","Agents"],"summary":"Update Agent Heartbeat","description":"Обновление heartbeat агента","operationId":"update_agent_heartbeat_v1_agents__agent_id__heartbeat_post","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"integer","title":"Agent Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentHeartbeatSchema"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/agents/{agent_id}/tasks/pull":{"post":{"tags":["API v1","Agents"],"summary":"Pull Task","description":"Запрос новой задачи для агента","operationId":"pull_task_v1_agents__agent_id__tasks_pull_post","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"integer","title":"Agent Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/agents/{agent_id}/tasks/{task_id}/status":{"post":{"tags":["API v1","Agents"],"summary":"Update Task Status","description":"Обновление статуса задачи","operationId":"update_task_status_v1_agents__agent_id__tasks__task_id__status_post","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"integer","title":"Agent Id"}},{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentTaskStatusUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/agents/{agent_id}/info":{"get":{"tags":["API v1","Agents"],"summary":"Get Agent Info","description":"Получение информации о зарегистрированном агенте","operationId":"get_agent_info_v1_agents__agent_id__info_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"integer","title":"Agent Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/agents/{agent_id}":{"patch":{"tags":["API v1","Agents"],"summary":"Update Agent","description":"Обновление параметров/характеристик агента","operationId":"update_agent_v1_agents__agent_id__patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"integer","title":"Agent Id"}},{"name":"X-Agent-Secret-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Agent-Secret-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/agents/{agent_id}/init":{"post":{"tags":["API v1","Agents"],"summary":"Init Agent","description":"Инициализация агента с параметрами железа, загрузки и hardware_info по secret_key","operationId":"init_agent_v1_agents__agent_id__init_post","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"integer","title":"Agent Id"}},{"name":"X-Agent-Secret-Key","in":"header","required":true,"schema":{"type":"string","title":"X-Agent-Secret-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentInitSchema"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/health":{"get":{"tags":["API v1"],"summary":"Health Check","operationId":"health_check_v1_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AgentHeartbeatSchema":{"properties":{"status":{"type":"string","minLength":1,"title":"Status"},"cpu_usage":{"anyOf":[{"type":"number","maximum":100.0,"minimum":0.0},{"type":"null"}],"title":"Cpu Usage"},"memory_usage":{"anyOf":[{"type":"number","maximum":100.0,"minimum":0.0},{"type":"null"}],"title":"Memory Usage"},"gpu_usage":{"anyOf":[{"additionalProperties":{"type":"number"},"type":"object"},{"type":"null"}],"title":"Gpu Usage"},"disk_usage":{"anyOf":[{"additionalProperties":{"type":"number"},"type":"object"},{"type":"null"}],"title":"Disk Usage"},"network_usage":{"anyOf":[{"additionalProperties":{"type":"number"},"type":"object"},{"type":"null"}],"title":"Network Usage"}},"type":"object","required":["status"],"title":"AgentHeartbeatSchema","description":"Схема для heartbeat агента"},"AgentInitSchema":{"properties":{"hostname":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Hostname"},"location":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Location"},"price_per_hour":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Price Per Hour"},"max_duration_hours":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Duration Hours"},"total_ram_gb":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Total Ram Gb"},"ram_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ram Type"},"ip_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ip Address"},"status":{"type":"string","minLength":1,"title":"Status"},"cpu_usage":{"anyOf":[{"type":"number","maximum":100.0,"minimum":0.0},{"type":"null"}],"title":"Cpu Usage"},"memory_usage":{"anyOf":[{"type":"number","maximum":100.0,"minimum":0.0},{"type":"null"}],"title":"Memory Usage"},"gpu_usage":{"anyOf":[{"additionalProperties":{"type":"number"},"type":"object"},{"type":"null"}],"title":"Gpu Usage"},"disk_usage":{"anyOf":[{"additionalProperties":{"type":"number"},"type":"object"},{"type":"null"}],"title":"Disk Usage"},"network_usage":{"anyOf":[{"additionalProperties":{"type":"number"},"type":"object"},{"type":"null"}],"title":"Network Usage"},"hardware_info":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Hardware Info"}},"type":"object","required":["status"],"title":"AgentInitSchema","description":"Схема для инициализации агента (все параметры железа и загрузки)"},"AgentRegisterSchema":{"properties":{"owner_user_id":{"type":"integer","title":"Owner User Id"}},"type":"object","required":["owner_user_id"],"title":"AgentRegisterSchema","description":"Схема для регистрации агента (только owner_user_id)"},"AgentStatus":{"type":"string","enum":["online","offline","error"],"title":"AgentStatus"},"AgentTaskStatusUpdate":{"properties":{"status":{"type":"string","minLength":1,"title":"Status"},"progress":{"anyOf":[{"type":"number","maximum":100.0,"minimum":0.0},{"type":"null"}],"title":"Progress"},"output":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Output"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"},"container_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Container Id"}},"type":"object","required":["status"],"title":"AgentTaskStatusUpdate","description":"Схема для обновления статуса задачи"},"AgentUpdate":{"properties":{"hostname":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Hostname"},"location":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Location"},"status":{"anyOf":[{"$ref":"#/components/schemas/AgentStatus"},{"type":"null"}]},"ip_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ip Address"},"price_per_hour":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Price Per Hour"},"verified":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Verified"},"reliability":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Reliability"},"max_duration_hours":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Duration Hours"},"last_seen":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Seen"},"total_ram_gb":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Total Ram Gb"},"ram_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ram Type"},"platform_info_json":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Platform Info Json"},"secret_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Secret Key"}},"type":"object","title":"AgentUpdate"},"ConfirmRegisterSchema":{"properties":{"temp_token":{"type":"string","title":"Temp Token"},"confirmation_code":{"type":"string","title":"Confirmation Code"}},"type":"object","required":["temp_token","confirmation_code"],"title":"ConfirmRegisterSchema","description":"Схема для подтверждения регистрации"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"OrderCreateSchema":{"properties":{"agent_id":{"type":"integer","title":"Agent Id"},"gpus_allocated":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Gpus Allocated"},"cpus_allocated":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Cpus Allocated"},"disks_allocated":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Disks Allocated"},"ram_allocated":{"type":"integer","title":"Ram Allocated"},"storage_allocated":{"type":"integer","title":"Storage Allocated"},"net_up_allocated":{"type":"integer","title":"Net Up Allocated"},"net_down_allocated":{"type":"integer","title":"Net Down Allocated"},"docker_image":{"type":"string","title":"Docker Image"},"duration_hours":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Duration Hours","default":1}},"type":"object","required":["agent_id","ram_allocated","storage_allocated","net_up_allocated","net_down_allocated","docker_image"],"title":"OrderCreateSchema","description":"Схема для создания заказа"},"ResponseSchema":{"properties":{"exception":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Exception"},"data":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Data"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"}},"type":"object","title":"ResponseSchema"},"UserLoginSchema":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","password"],"title":"UserLoginSchema"},"UserRegisterSchema":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"username":{"type":"string","title":"Username"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","username","password"],"title":"UserRegisterSchema"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}},"tags":[{"name":"Users","description":"User management and authentication"},{"name":"Agents","description":"GPU server management"},{"name":"Hardware","description":"CPU, GPU, Disk, Network specifications"},{"name":"Tasks","description":"Rental task management"}]}